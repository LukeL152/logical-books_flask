{% extends 'base.html' %}
{% from '_macros.html' import render_account_options %}

{% block title %}Edit Account - Logical Books{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Edit Account: {{ account.name }}</h2>
    <hr>
    <form method="POST" action="{{ url_for('edit_account', account_id=account.id) }}" class="row g-3">
        <div class="col-md-4">
            <label for="name" class="form-label">Account Name</label>
            <input type="text" id="name" name="name" class="form-control" value="{{ account.name }}" required>
        </div>
        <div class="col-md-4">
            <label for="parent_id" class="form-label">Parent Account</label>
            <select id="parent_id" name="parent_id" class="form-select">
                <option value="None" {% if account.parent_id is none %}selected{% endif %}>None (Top-Level Account)</option>
                {{ render_account_options(account_choices, selected_id=account.parent_id) }}
            </select>
        </div>
        <div class="col-md-4">
            <label for="type" class="form-label">Account Type</label>
            <select id="type" name="type" class="form-select" required>
                <option value="Asset" {% if account.type == 'Asset' %}selected{% endif %}>Asset</option>
                <option value="Liability" {% if account.type == 'Liability' %}selected{% endif %}>Liability</option>
                <option value="Equity" {% if account.type == 'Equity' %}selected{% endif %}>Equity</option>
                <option value="Revenue" {% if account.type == 'Revenue' %}selected{% endif %}>Revenue</option>
                <option value="Expense" {% if account.type == 'Expense' %}selected{% endif %}>Expense</option>
                <option value="Accounts Receivable" {% if account.type == 'Accounts Receivable' %}selected{% endif %}>Accounts Receivable</option>
                <option value="Accounts Payable" {% if account.type == 'Accounts Payable' %}selected{% endif %}>Accounts Payable</option>
            </select>
        </div>
        <div class="col-md-4">
            <label for="category" class="form-label">Category</label>
            <input type="text" id="category" name="category" class="form-control" value="{{ account.category or '' }}">
        </div>
        <div class="col-md-2">
            <label for="opening_balance" class="form-label">Opening Balance</label>
            <input type="number" step="0.01" id="opening_balance" name="opening_balance" class="form-control" value="{{ account.opening_balance }}" required>
        </div>
        <div class="col-12">
            <button type="submit" class="btn btn-primary">Update Account</button>
            <a href="{{ url_for('accounts') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
$(document).ready(function() {
    $('#parent_id').select2();
});
</script>
{% endblock %}
